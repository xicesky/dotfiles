#!/bin/bash
declare target="$1"; shift

if [[ "$MSYSTEM" = M* ]] ; then
    # On MinGW / MSYS, convert paths
    if echo "$target" | grep -qP '^\w+:' ; then
        # Target is a URL
        true
    else
        target="$(cygpath -w "$target")"
    fi
    #echo start "$target"
    start "$target"
elif grep -qi microsoft /proc/version ; then
    # On WSL2
    if echo "$target" | grep -qP '^\w+:' ; then
        # Target is a URL
        true
    else
        target="$(wslpath -w "$target")"
    fi
    # This works for directories, probably not for files
    explorer.exe "$target"
else
    # FIXME: Detect OSX
    xdg-open "$target"
fi

